<!DOCTYPE html>
<html lang="ko">

<head lang="ko">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- title -->
    

    <!-- description -->
    

    <!-- image -->
    

    <title>gradle로 npm install & npm run build 자동화 | toughhyeok</title>
    <meta name="description" content="Gradle build 전에 npm run build 먼저 실행되도록 하기 plugins plugins { id 'org.springframework.boot' version '2.6.7'...">

    <!-- Open Graph : 링크 미리보기 -->
    <meta property="og:site_name" content="toughhyeok">
    <meta property="og:type" content="article"/>
    <meta property="og:url" content="https://toughhyeok.github.io/2022-05-09/automation-npm-run-build"/>
    <meta property="og:image" content="https://toughhyeok.github.io/assets/images/common/gradle-logo.png">
    <meta property="og:title" content="gradle로 npm install & npm run build 자동화 | toughhyeok">
    <meta property="og:description" content="Gradle build 전에 npm run build 먼저 실행되도록 하기 plugins plugins { id 'org.springframework.boot' version '2.6.7'..."/>

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="gradle로 npm install & npm run build 자동화 | toughhyeok">
    <meta name="twitter:description" content="Gradle build 전에 npm run build 먼저 실행되도록 하기 plugins plugins { id 'org.springframework.boot' version '2.6.7'...">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" rel="stylesheet">

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600,700" rel="stylesheet">

    <!-- Syntax Highlight -->
    <link rel="stylesheet" href="/assets/lib/highlight.js-11.0.1/rainbow.css">
    <script src="/assets/lib/highlight.js-11.0.1/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

    <!-- JS -->
    <script type="text/javascript" src="/assets/scripts/post.js"></script>

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/styles/styles.css">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon/favicon-16x16.png">
    <link rel="manifest" href="/assets/images/favicon/site.webmanifest">
    <link rel="mask-icon" href="/assets/images/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">

    <meta name="naver-site-verification" content=""/>

    <!-- Start Google Analytics - Global Site Tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id="></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', '');
    </script>
    <!-- End Google Analytics -->

    <!-- Start Jennifer -->
    <script>
    (function(j,en,ni,fer) {
        j['dmndata']=[];j['jenniferFront']=function(args){window.dmndata.push(args)};
        j['dmnaid']=fer;j['dmnatime']=new Date();j['dmnanocookie']=false;j['dmnajennifer']='JENNIFER_FRONT@INTG';
        var b=Math.floor(new Date().getTime() / 60000) * 60000;var a=en.createElement(ni);
        a.src='https://d-collect.jennifersoft.com/'+fer+'/demian.js?'+b;a.async=true;
        en.getElementsByTagName(ni)[0].parentNode.appendChild(a);
    }(window,document,'script',''));
    </script>
    <!-- End Jennifer -->

</head>

<body>



<nav class="nav">
    <div class="nav-container">
        <ul>
            <li class="transition">
                <a href="/"  >Home</a>
            </li>
            <li class="transition">
                <a href="/post"  class="active"  >Post</a>
            </li>
        </ul>
    </div>
</nav>


<div class="post-header loading-animation "
     style="background-image: url('/assets/images/common/gradle-logo.png')">
</div>


<!-- 업로드 후, 지난 날짜 계산. 일주일 이내에 포스트 라면 New 태그 등록 -->





<main>
    <div class="post">
        <div class="post-info">
            <div class="post-type-tag">
                
                <div class="catalogue-tag">
                    New
                </div>
                
                <div class="post-type">
                    gradle
                </div>
            </div>
            <h1 class="post-title">
                gradle로 npm install & npm run build 자동화
            </h1>
            <h2 class="post-subtitle">
                view automatic deployment
            </h2>
        </div>

        <!-- draft 일 때 -->
        
        <!-- 큐레이션 영역 -->
        <h3 id="gradle-build-전에-npm-run-build-먼저-실행되도록-하기">Gradle build 전에 <code class="language-plaintext highlighter-rouge">npm run build</code> 먼저 실행되도록 하기</h3>

<h4 id="plugins">plugins</h4>
<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">plugins</span> <span class="o">{</span>
	<span class="n">id</span> <span class="s1">'org.springframework.boot'</span> <span class="n">version</span> <span class="s1">'2.6.7'</span>
	<span class="n">id</span> <span class="s1">'io.spring.dependency-management'</span> <span class="n">version</span> <span class="s1">'1.0.11.RELEASE'</span>
	<span class="n">id</span> <span class="s1">'com.github.node-gradle.node'</span> <span class="n">version</span> <span class="s1">'3.2.1'</span>
	<span class="n">id</span> <span class="s1">'java'</span>
<span class="o">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">gradle</code>이 <code class="language-plaintext highlighter-rouge">node</code>를 사용할 수 있게 plugin 추가</p>

<p>참고 : <a href="https://github.com/node-gradle/gradle-node-plugin">gradle-node</a></p>

<h4 id="node">node</h4>
<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">node</span> <span class="o">{</span>
	<span class="c1">// node.js version</span>
	<span class="n">version</span> <span class="o">=</span> <span class="s1">'17.3.1'</span>
	<span class="n">download</span> <span class="o">=</span> <span class="kc">true</span> <span class="c1">// true가 아닐 경우 global로 설치된 node.js가 있어야 한다.</span>
	<span class="n">nodeProjectDir</span> <span class="o">=</span> <span class="n">file</span><span class="o">(</span><span class="s2">"./src/main/view"</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">node</code> 버전 설정, download 유무 설정, view 디렉토리 설정 (여기서 view 디렉토리는 front-end 디렉토리를 의미합니다. <code class="language-plaintext highlighter-rouge">"src/main/view"</code>)</p>

<h4 id="task">task</h4>
<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">task</span> <span class="nf">setUp</span><span class="o">(</span><span class="nl">type:</span> <span class="n">NpmTask</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">description</span> <span class="o">=</span> <span class="s2">"Install Node.js packages"</span>
	<span class="n">args</span> <span class="o">=</span> <span class="o">[</span><span class="s1">'install'</span><span class="o">]</span>
<span class="o">}</span>

<span class="n">task</span> <span class="nf">buildView</span><span class="o">(</span><span class="nl">type:</span> <span class="n">NpmTask</span><span class="o">,</span> <span class="nl">dependsOn:</span> <span class="n">setUp</span><span class="o">){</span>
	<span class="n">description</span> <span class="o">=</span> <span class="s2">"Build Vue.js"</span>
	<span class="n">args</span> <span class="o">=</span> <span class="o">[</span><span class="s1">'run'</span><span class="o">,</span> <span class="s1">'build'</span><span class="o">]</span>
<span class="o">}</span>
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">buildView</code>는 <code class="language-plaintext highlighter-rouge">setUp</code>이 실행되고 나서 실행됩니다.</p>

<p><code class="language-plaintext highlighter-rouge">type</code>이 <code class="language-plaintext highlighter-rouge">NpmTask</code>인 <code class="language-plaintext highlighter-rouge">task</code>는 <code class="language-plaintext highlighter-rouge">npm</code>으로 시작하고 뒤에 <code class="language-plaintext highlighter-rouge">args</code>들이 따라옵니다.</p>

<p><code class="language-plaintext highlighter-rouge">setUp</code>은 <code class="language-plaintext highlighter-rouge">npm install</code>과 같은 기능을 합니다. <code class="language-plaintext highlighter-rouge">package.json</code>에 작성된 모듈을 <code class="language-plaintext highlighter-rouge">src/main/view/node_modules</code>에 설치합니다.</p>

<p><code class="language-plaintext highlighter-rouge">buildView</code>는 <code class="language-plaintext highlighter-rouge">npm run build</code>와 같은 기능을 합니다. <code class="language-plaintext highlighter-rouge">.vue</code>, <code class="language-plaintext highlighter-rouge">.css</code>, <code class="language-plaintext highlighter-rouge">.js</code> 그리고 이미지 파일들을 <code class="language-plaintext highlighter-rouge">src/main/resources/static</code>에 <code class="language-plaintext highlighter-rouge">.html</code>, <code class="language-plaintext highlighter-rouge">.js</code>, <code class="language-plaintext highlighter-rouge">.css</code> 그리고 이미지 파일로 변환하여 저장합니다. <code class="language-plaintext highlighter-rouge">src/main/resources/static</code>은 SpringBoot가 <code class="language-plaintext highlighter-rouge">index.html</code>을 찾는 장소 중 하나입니다.</p>

<h4 id="processresources">processResources</h4>

<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">processResources</span><span class="o">.</span><span class="na">dependsOn</span> <span class="s1">'buildView'</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">buildView</code>를 실행할 때 <code class="language-plaintext highlighter-rouge">setUp</code>이 먼저 실행되야 하므로 최종적으로 동작 순서는 다음과 같습니다.</p>

<p><code class="language-plaintext highlighter-rouge">setUp</code> –&gt; <code class="language-plaintext highlighter-rouge">buildView</code></p>

<h4 id="buildgradle-전체-코드">build.gradle 전체 코드</h4>

<div class="language-gradle highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// build.gradle</span>
<span class="n">plugins</span> <span class="o">{</span>
	<span class="n">id</span> <span class="s1">'org.springframework.boot'</span> <span class="n">version</span> <span class="s1">'2.6.7'</span>
	<span class="n">id</span> <span class="s1">'io.spring.dependency-management'</span> <span class="n">version</span> <span class="s1">'1.0.11.RELEASE'</span>
	<span class="n">id</span> <span class="s1">'com.github.node-gradle.node'</span> <span class="n">version</span> <span class="s1">'3.2.1'</span>
	<span class="n">id</span> <span class="s1">'java'</span>
<span class="o">}</span>

<span class="n">group</span> <span class="o">=</span> <span class="s1">'com.example'</span>
<span class="n">version</span> <span class="o">=</span> <span class="s1">'0.0.1-SNAPSHOT'</span>
<span class="n">sourceCompatibility</span> <span class="o">=</span> <span class="mf">1.8</span>

<span class="k">repositories</span> <span class="o">{</span>
	<span class="n">mavenCentral</span><span class="o">()</span>
<span class="o">}</span>

<span class="n">node</span> <span class="o">{</span>
	<span class="c1">// node.js version</span>
	<span class="n">version</span> <span class="o">=</span> <span class="s1">'17.3.1'</span>
	<span class="n">download</span> <span class="o">=</span> <span class="kc">true</span> <span class="c1">// true가 아닐 경우 global로 설치된 node.js가 있어야 한다.</span>
	<span class="n">nodeProjectDir</span> <span class="o">=</span> <span class="n">file</span><span class="o">(</span><span class="s2">"./src/main/view"</span><span class="o">)</span>
<span class="o">}</span>

<span class="n">task</span> <span class="nf">setUp</span><span class="o">(</span><span class="nl">type:</span> <span class="n">NpmTask</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">description</span> <span class="o">=</span> <span class="s2">"Install Node.js packages"</span>
	<span class="n">args</span> <span class="o">=</span> <span class="o">[</span><span class="s1">'install'</span><span class="o">]</span>
<span class="o">}</span>

<span class="n">task</span> <span class="nf">buildView</span><span class="o">(</span><span class="nl">type:</span> <span class="n">NpmTask</span><span class="o">,</span> <span class="nl">dependsOn:</span> <span class="n">setUp</span><span class="o">){</span>
	<span class="n">description</span> <span class="o">=</span> <span class="s2">"Build Vue.js"</span>
	<span class="n">args</span> <span class="o">=</span> <span class="o">[</span><span class="s1">'run'</span><span class="o">,</span> <span class="s1">'build'</span><span class="o">]</span>
<span class="o">}</span>

<span class="k">dependencies</span> <span class="o">{</span>
	<span class="n">implementation</span> <span class="s1">'org.springframework.boot:spring-boot-starter-web'</span>
	<span class="n">testImplementation</span> <span class="s1">'org.springframework.boot:spring-boot-starter-test'</span>
	<span class="n">implementation</span> <span class="s1">'org.springframework.boot:spring-boot-starter-data-jpa'</span>
	<span class="n">implementation</span> <span class="s1">'com.h2database:h2'</span>
	<span class="n">implementation</span> <span class="s1">'org.projectlombok:lombok'</span>
	<span class="n">annotationProcessor</span> <span class="s1">'org.projectlombok:lombok'</span>
<span class="o">}</span>

<span class="n">tasks</span><span class="o">.</span><span class="na">named</span><span class="o">(</span><span class="s1">'test'</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">useJUnitPlatform</span><span class="o">()</span>
<span class="o">}</span>

<span class="n">processResources</span><span class="o">.</span><span class="na">dependsOn</span> <span class="s1">'buildView'</span>
</code></pre></div></div>

        
    </div>

    
        <script>
    (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s);
        js.id = id;
        js.src = 'https://connect.facebook.net/ko_KR/sdk.js#xfbml=1&version=v2.10&appId=1607605225977118';
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>

<script>
    window.twttr = (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0], t = window.twttr || {};
        if (d.getElementById(id)) return t;
        js = d.createElement(s);
        js.id = id;
        js.src = 'https://platform.twitter.com/widgets.js';
        fjs.parentNode.insertBefore(js, fjs);
        t._e = [];
        t.ready = function (f) {
            t._e.push(f);
        };
        return t;
    }(document, 'script', 'twitter-wjs'));
</script>

<section class="share transition">
    <div class="share-twitter">
        <a class="twitter-share-button" href="https://twitter.com/intent/tweet" data-size="large">Tweet</a>
    </div>
    <div class="share-facebook">
        <div class="fb-share-button" data-href="https://toughhyeok.github.io/2022-05-09/automation-npm-run-build" data-layout="button_count"
             data-size="large" data-mobile-iframe="true">
            <a class="fb-xfbml-parse-ignore" target="_blank"
               href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdevelopers.facebook.com%2Fdocs%2Fplugins%2F&amp;src=sdkpreparse">공유하기</a>
        </div>
    </div>
</section>
    

    <script src="https://utteranc.es/client.js"
        repo="toughhyeok/toughhyeok.github.io"
        issue-term="title"
        label="💬 comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
</main>


<footer>
    <address class="footer_wrap">
        <div class="information">
            <div class="myname">
                Park Junhyeok
            </div>
            <a href="mailto:toughhyeok96@gmail.com" class="email">
                toughhyeok96@gmail.com
            </a>
            <div class="accounts">
                <!-- github -->
                <a href="http://github.com/toughhyeok/toughhyeok.github.io" target="_blank" class="transition">
                    <svg viewBox="0 0 32.6 31.8">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M16.3,0C7.3,0,0,7.3,0,16.3c0,7.2,4.7,13.3,11.1,15.5
                    c0.8,0.1,1.1-0.4,1.1-0.8c0-0.4,0-1.4,0-2.8c-4.5,1-5.5-2.2-5.5-2.2c-0.7-1.9-1.8-2.4-1.8-2.4c-1.5-1,0.1-1,0.1-1
                    c1.6,0.1,2.5,1.7,2.5,1.7c1.5,2.5,3.8,1.8,4.7,1.4c0.1-1.1,0.6-1.8,1-2.2c-3.6-0.4-7.4-1.8-7.4-8.1c0-1.8,0.6-3.2,1.7-4.4
                    C7.4,10.7,6.8,9,7.7,6.8c0,0,1.4-0.4,4.5,1.7c1.3-0.4,2.7-0.5,4.1-0.5c1.4,0,2.8,0.2,4.1,0.5c3.1-2.1,4.5-1.7,4.5-1.7
                    c0.9,2.2,0.3,3.9,0.2,4.3c1,1.1,1.7,2.6,1.7,4.4c0,6.3-3.8,7.6-7.4,8c0.6,0.5,1.1,1.5,1.1,3c0,2.2,0,3.9,0,4.5
                    c0,0.4,0.3,0.9,1.1,0.8c6.5-2.2,11.1-8.3,11.1-15.5C32.6,7.3,25.3,0,16.3,0z"></path>
                    </svg>
                </a>
                <!-- linkdin
                <a href="http://www.linkedin.com/in/<userid>/" target="_blank" class="transition">
                    <svg viewBox="0 0 38.3 38.3">
                        <g>
                        <rect x="0.8" y="12.8" width="7.9" height="25.5"></rect>
                        <ellipse cx="4.7" cy="4.7" rx="4.7" ry="4.7"></ellipse>
                        <path d="M21.3,24.9c0-3.6,1.7-5.7,4.8-5.7c2.9,0,4.3,2.1,4.3,5.7c0,3.7,0,13.4,0,13.4h7.9c0,0,0-9.3,0-16.2
                        c0-6.8-3.9-10.1-9.3-10.1s-7.7,4.2-7.7,4.2v-3.4h-7.6v25.5h7.6C21.3,38.3,21.3,28.8,21.3,24.9z"></path>
                            </g>
                    </svg>
                </a> -->
                <!-- instagram -->
                <a href="http://instagram.com/junhyeo.k" target="_blank" class="transition">
                    <svg viewBox="0 0 40.2 40.3">
                    <g>
                    <path d="M20.2,3.6c5.4,0,6,0,8.2,0.1c2,0.1,3,0.4,3.7,0.7C33,4.8,33.7,5.3,34.4,6s1.1,1.4,1.5,2.3
                    c0.3,0.7,0.6,1.8,0.7,3.7c0.1,2.1,0.1,2.8,0.1,8.2s0,6-0.1,8.2c-0.1,2-0.4,3-0.7,3.7c-0.4,0.9-0.8,1.6-1.5,2.3s-1.4,1.1-2.3,1.5
                    c-0.7,0.3-1.8,0.6-3.7,0.7c-2.1,0.1-2.8,0.1-8.2,0.1s-6,0-8.2-0.1c-2-0.1-3-0.4-3.7-0.7c-0.9-0.4-1.6-0.8-2.3-1.5S4.9,33,4.5,32.1
                    c-0.3-0.7-0.6-1.8-0.7-3.7c-0.1-2.1-0.1-2.8-0.1-8.2s0-6,0.1-8.2c0.1-2,0.4-3,0.7-3.7C4.8,7.3,5.3,6.7,6,6s1.4-1.1,2.3-1.5
                    C9,4.2,10.1,3.8,12,3.8C14.2,3.7,14.8,3.6,20.2,3.6 M20.2,0c-5.5,0-6.2,0-8.3,0.1C9.7,0.2,8.2,0.6,7,1.1C5.6,1.6,4.5,2.3,3.4,3.4
                    S1.6,5.6,1.1,7c-0.5,1.3-0.8,2.8-0.9,4.9C0,14,0,14.7,0,20.2s0,6.2,0.1,8.3s0.4,3.6,0.9,4.9c0.5,1.3,1.2,2.5,2.3,3.6
                    s2.2,1.8,3.6,2.3c1.3,0.5,2.8,0.8,4.9,0.9c2.2,0.1,2.8,0.1,8.3,0.1s6.2,0,8.3-0.1s3.6-0.4,4.9-0.9c1.3-0.5,2.5-1.2,3.6-2.3
                    s1.8-2.2,2.3-3.6c0.5-1.3,0.8-2.8,0.9-4.9c0.1-2.2,0.1-2.8,0.1-8.3s0-6.2-0.1-8.3S39.7,8.3,39.2,7S38,4.5,36.9,3.4
                    s-2.2-1.8-3.6-2.3c-1.3-0.5-2.8-0.8-4.9-0.9C26.3,0,25.7,0,20.2,0L20.2,0L20.2,0z"></path>
                    <path d="M20.2,9.8c-5.7,0-10.4,4.6-10.4,10.4s4.6,10.4,10.4,10.4S30.6,26,30.6,20.2S25.9,9.8,20.2,9.8L20.2,9.8z
                    M20.2,26.9c-3.7,0-6.7-3-6.7-6.7s3-6.7,6.7-6.7s6.7,3,6.7,6.7C26.9,23.9,23.9,26.9,20.2,26.9L20.2,26.9z"></path>
                    <path d="M33.4,9.4c0,1.3-1.1,2.4-2.4,2.4s-2.4-1.1-2.4-2.4s1-2.4,2.3-2.4C32.2,7,33.4,8.1,33.4,9.4L33.4,9.4z"></path>
                    </g>
                </svg>
                </a>
                <!-- twitter
                <a href="http://twitter.com/<userid>" target="_blank" class="transition">
                    <svg viewBox="0 0 40.7 33.1">
                    <path d="M0,29.3c3.7,2.4,8.1,3.8,12.8,3.8c15.5,0,24.3-13.1,23.7-24.8c1.6-1.2,3-2.6,4.2-4.3
                    c-1.5,0.7-3.1,1.1-4.8,1.3c1.7-1,3-2.7,3.7-4.6c-1.6,1-3.4,1.7-5.3,2C32.7,1,30.6,0,28.2,0c-5.4,0-9.4,5-8.1,10.3
                    C13.1,9.9,7,6.6,2.8,1.5c-2.2,3.8-1.1,8.7,2.6,11.1c-1.4,0-2.7-0.4-3.8-1c-0.1,3.9,2.7,7.5,6.7,8.3c-1.2,0.3-2.5,0.4-3.8,0.1
                    c1.1,3.3,4.1,5.7,7.8,5.8C8.9,28.6,4.4,29.8,0,29.3z"></path>
                    </svg>
                </a> -->
            </div>
        </div>
        <div class="copyright">
            <span>
                &copy; Park Junhyeok. <time datetime="2022-05-09 21:55:24 +0900">2022</time>
            </span>
        </div>    
    </address>
</footer>
</body>

</html>


